## 基础知识
### USB的传输类型：
- 控制传输：可靠，时间没有保证，比如：USB设备的识别过程
- 批量传输：可靠，时间没有保证，比如：U盘
- 中断传输：可靠，实时，比如：USB鼠标
- 实时传输：不可靠，实时，比如：USB摄像头

### USB传输的对象：端点（endpoint）
- USB里所有的设备都是端点
- 除了端点0外，每一个端点只支持一个方向的数据传输
- 端点0用于控制传输，既能输出也能输入
- 每一个端点都有传输类型，传输方向
- 术语里，程序里说的输入，输出“都是”基于USB主机的立场说的。比如鼠标的数据是从鼠标传到PC机，对应的端点称为“输入端点”
- USB总线驱动程序的作用：
	- 识别USB设备
	- 查找并安装对应的设备驱动程序
	- 提供USB读写函数
- USB驱动程序框架：
```
						USB设备驱动程序
						USB总线驱动程序
						 USB主机控制器
						    USB设备
```

- 规范：
	- UHCI：intel		低速（1.5Mbps）/全速（12Mbps）
	- OHCI：Microsoft	低速/全速
	- EHCI				高速（480Mbps）

### 怎么写USB驱动程序：
- 分配/注册usb_driver结构体
```
.id_table
.probe
.disconnect
```
- 具体内容多看内核的其他USB驱动

### 其他
- 推荐书籍：《Linux内核源代码情景分析》
- 可以参考内核源码下的usbmouse.c

## 实验
用鼠标当键盘用，左右中键分别是l，s，回车键

1. 去掉内核原本
`make menuconfig`
2. 编译内核
`make uImage`
3. 加载模块
`insmod usbmouse_as_key.ko`
4. 插入并按下鼠标按键，观察效果；拔出鼠标，观察效果



